{% include "headitem.html.twig" with {title: "d3mxd3cleartmp"|translate} %}

{% if readonly %}
    {% set readonly = "readonly disabled" %}
{% else %}
    {% set readonly = "" %}
{% endif %}
<form name="transfer" id="transfer" action="{{ oViewConf.getSelfLink()|raw }}" method="post">
    {{ oViewConf.getHiddenSid()|raw }}
    <input type="hidden" name="oxid" value="{{ oxid }}">
    <input type="hidden" name="oxidCopy" value="{{ oxid }}">
    <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName()|raw }}">
</form>

<form name="myedit" id="myedit" action="{{ oViewConf.getSelfLink()|raw }}" method="post">
    {{ oViewConf.getHiddenSid()|raw }}
    <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName()|raw }}">
    <input type="hidden" name="fnc" value="">
    <input type="hidden" name="oxid" value="{{ oxid }}">
    <input type="hidden" name="voxid" value="{{ oxid }}">
</form>

<script type="text/javascript">
    {% if oView.getTickerUrl() %}
        window.open('{{ oView.getTickerUrl() }}', 'clrTmpTicker', 'width=300, height=300, left=100');
    {% endif %}

    function deselect_combineditem()
    {
        {% block d3cleartmp_js_combineditem %}
            document.getElementById('clearall').checked = false;
        {% endblock %}
    }

    function deselect_singleitems()
    {
        {% block d3cleartmp_js_singleitems %}
            document.getElementById('clearfrontend').checked = false;
            document.getElementById('cleardbcache').checked = false;
            document.getElementById('clearlangcache').checked = false;
            document.getElementById('clearmenucache').checked = false;
            document.getElementById('clearclasspathcache').checked = false;
            document.getElementById('clearstructurecache').checked = false;
            document.getElementById('cleartagcloudcache').checked = false;
            document.getElementById('clearseocache').checked = false;
            document.getElementById('clearviewcache').checked = false;
            document.getElementById('clearmodulecache').checked = false;
            document.getElementById('cleargeneratedimgs').checked = false;
        {% endblock %}
    }
</script>

{% set oCfg = oView.d3GetSet() %}
{% set blDevMode = oCfg.getValue('blClrTmp_notmpuse') %}

<style>
    table#statistik td {
        padding: 4px;
    }

    table#statistik td.bold {
        font-weight: bold;
    }

    #popup2 {
        display: none;
    }

    .d3modcfg_btn.commandBtn {
        margin-right: 10px;
        margin-bottom: 10px;
    }
</style>

<table style="width: 98%; border: none; padding: 0; border-spacing: 0; border-collapse: collapse">
    <tr>
        <td style="vertical-align: top; width: 50%;" class="edittext">
            {% block d3cleartmp_syscommand1 %}
                {% if oCfg.getValue('sClrTmp_systemaction1command') %}
                    <span class="d3modcfg_btn icon d3color-green commandBtn">
                        <button onclick="this.style.color = 'red'; window.location.href = '{{ oViewConf.getSelfLink()|raw }}&cl={{ oViewConf.getActiveClassName()|raw }}&amp;fnc=d3ExecCommand1&amp;';" title="{{ oCfg.getValue('sClrTmp_systemaction1name') }}">
                            {% if oCfg.getValue('sClrTmp_systemaction1icon') %}
                                <i class="fa {{ oCfg.getValue('sClrTmp_systemaction1icon') }}"></i>
                            {% endif %}
                            {{ oCfg.getValue('sClrTmp_systemaction1name') }}
                        </button>
                    </span>
                {% endif %}
            {% endblock %}

            {% block d3cleartmp_syscommand2 %}
                {% if oCfg.getValue('sClrTmp_systemaction2command') %}
                    <span class="d3modcfg_btn icon d3color-green commandBtn">
                        <button onclick="this.style.color = 'red'; window.location.href = '{{ oViewConf.getSelfLink()|raw }}&cl={{ oViewConf.getActiveClassName()|raw }}&amp;fnc=d3ExecCommand2&amp;';" title="{{ oCfg.getValue('sClrTmp_systemaction2name') }}">
                            {% if oCfg.getValue('sClrTmp_systemaction2icon') %}
                                <i class="fa {{ oCfg.getValue('sClrTmp_systemaction2icon') }}"></i>
                            {% endif %}
                            {{ oCfg.getValue('sClrTmp_systemaction2name') }}
                        </button>
                    </span>
                {% endif %}
            {% endblock %}

            <div class="clear"></div>

            {% block d3cleartmp_form %}
                <form name="delform" id="delform" action="{{ oViewConf.getSelfLink()|raw }}" method="post" onsubmit="{% if not oView.hasTicker() %}document.getElementById('mask').className='on';document.getElementById('popup2').className='d3loader-2 on';{% endif %} return;">
                    {{ oViewConf.getHiddenSid()|raw }}
                    <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName()|raw }}">
                    {% if oView.hasTicker() %}
                        <input type="hidden" name="fnc" value="startTicker">
                    {% else %}
                        <input type="hidden" name="fnc" value="clearTmp">
                    {% endif %}

                    <table style="border: none; padding: 0; border-spacing: 0; border-collapse: collapse">
                        {% block d3cleartmp_all %}
                            {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                                <tr>
                                    <td class="edittext" style="vertical-align: top;">
                                        <label for="clearall">{{ translate({ ident: "D3_CFG_CLRTMP_ALL" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearall" value="0">
                                        <input onClick="deselect_singleitems();" type="checkbox" value="1" class="edittext" id="clearall" name="clearall" {% if clearAll %}checked{% endif %} {{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endblock %}

                        {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                            <tr>
                                <td colspan="2" style="text-align: center;">{{ translate({ ident: "D3_CFG_CLRTMP_OR" }) }}</td>
                            </tr>
                        {% endif %}

                        {% block d3cleartmp_separated %}
                            {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearfrontend">{{ translate({ ident: "D3_CFG_CLRTMP_TPL" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearfrontend" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearfrontend" name="clearfrontend" value="1" class="edittext" name="clearfrontend" {% if clearFrontend %}checked{% endif %} {{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="cleardbcache">{{ translate({ ident: "D3_CFG_CLRTMP_DB" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="cleardbcache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="cleardbcache" value="1" class="edittext" name="cleardbcache" {% if clearDB %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearlangcache">{{ translate({ ident: "D3_CFG_CLRTMP_LANG" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearlangcache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearlangcache" value="1" class="edittext" name="clearlangcache" {% if clearLang %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearmenucache">{{ translate({ ident: "D3_CFG_CLRTMP_MENU" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearmenucache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearmenucache" value="1" class="edittext" name="clearmenucache" {% if clearMenu %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearclasspathcache">{{ translate({ ident: "D3_CFG_CLRTMP_CLASSPATH" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearclasspathcache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearclasspathcache" value="1" class="edittext" name="clearclasspathcache" {% if clearClassPath %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearstructurecache">{{ translate({ ident: "D3_CFG_CLRTMP_STRUCTURE" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearstructurecache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearstructurecache" value="1" class="edittext" name="clearstructurecache" {% if clearStructure %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="cleartagcloudcache">{{ translate({ ident: "D3_CFG_CLRTMP_TAGCLOUD" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="cleartagcloudcache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="cleartagcloudcache" value="1" class="edittext" name="cleartagcloudcache" {% if clearTagcloud %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearseocache">{{ translate({ ident: "D3_CFG_CLRTMP_SEO" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearseocache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearseocache" value="1" class="edittext" name="clearseocache" {% if clearSeo %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="edittext" style="vertical-align: top">
                                        <label for="clearmodulecache">{{ translate({ ident: "D3_CFG_CLRTMP_MODULE" })|raw }}</label>
                                    </td>
                                    <td class="edittext">
                                        <input type="hidden" name="clearmodulecache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearmodulecache" value="1" class="edittext" name="clearmodulecache" {% if clearModule %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endblock %}

                        {% block d3cleartmp_userdefined %}
                            {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                                {% if oView.getUserDefinedAction(1) %}
                                    <tr>
                                        <td class="edittext" style="vertical-align: top">
                                            <label for="clearuser1cache">{{ oView.getUserDefinedAction(1)|raw }}</label>
                                        </td>
                                        <td class="edittext">
                                            <input type="hidden" name="clearuser1cache" value="0">
                                            <input onClick="deselect_combineditem();" type="checkbox" id="clearuser1cache" value="1" class="edittext" name="clearuser1cache" {% if clearUser1 %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                        </td>
                                    </tr>
                                {% endif %}
                                {% if oView.getUserDefinedAction(2) %}
                                    <tr>
                                        <td class="edittext" style="vertical-align: top">
                                            <label for="clearuser2cache">{{ oView.getUserDefinedAction(2)|raw }}</label>
                                        </td>
                                        <td class="edittext">
                                            <input type="hidden" name="clearuser2cache" value="0">
                                            <input onClick="deselect_combineditem();" type="checkbox" id="clearuser2cache" value="1" class="edittext" name="clearuser2cache" {% if clearUser2 %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endif %}
                        {% endblock %}

                        {% block d3cleartmp_views %}
                            <tr>
                                <td class="edittext" style="vertical-align: top">
                                    <label for="clearviewcache">{{ translate({ ident: "D3_CFG_CLRTMP_VIEWS" })|raw }}</label>
                                </td>
                                <td class="edittext">
                                    <input type="hidden" name="clearviewcache" value="0">
                                        <input onClick="deselect_combineditem();" type="checkbox" id="clearviewcache" value="1" class="edittext" name="clearviewcache" {% if clearViews %}checked{% endif %}{{ readonly }} {% if blDevMode %}disabled {% endif %}>
                                </td>
                            </tr>
                        {% endblock %}

                        {% block d3cleartmp_additional %}
                        {% endblock %}


                        <tr>
                            <td class="edittext">
                            </td>
                            <td class="edittext"><br>
                                <br>
                                <span class="d3modcfg_btn icon d3color-green{% if blDevMode %}_inactive{% endif %}">
                                    <button id="sumbitbtn" type="submit" name="save" {% if blDevMode %}disabled="disabled" {% endif %} style="width: 150px;">
                                        <i class="fas fa-check-circle fa-inverse"></i>{{ translate({ ident: "D3_CFG_CLRTMP_SUBMIT" }) }}
                                    </button>
                                </span>
                            </td>
                        </tr>
                    </table>
                </form>
            {% endblock %}
        </td>
        <td style="vertical-align: top; text-align: left" class="edittext">
            {% block d3cleartmp_info %}
                {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                    <fieldset>
                        <legend>{{ translate({ ident: "D3_CFG_CLRTMP_STAT" }) }}</legend>

                        <table style="border: none; padding: 0; border-spacing: 0; border-collapse: collapse" id="statistik">
                            {% block d3cleartmp_infoitems %}
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_PATH" }) }}</td>
                                    <td>{{ oView.getTmpPath() }}</td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_COUNT" }) }}</td>
                                    <td>{{ oView.getTmpCount() }}</td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_SIZE" }) }}</td>
                                    <td>{{ oView.getTmpSize() }}</td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_DELFOLDER" }) }}</td>
                                    <td>
                                        <span style="float: left; margin-right: 10px;"
                                        {% if oCfg.getValue('blClrTmp_nofolderremove') %}
                                            class="fas fa-times-circle d3fa-17x d3fa-color-red" title="{{ translate({ ident: "D3_CFG_CLRTMP_NO" }) }}"
                                        {% else %}
                                            class="fas fa-check-circle d3fa-17x d3fa-color-green" title="{{ translate({ ident: "D3_CFG_CLRTMP_YES" }) }}"
                                        {% endif %}
                                        ></span>
                                        {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_CFG_CLRTMP_SET_DESC"), 'sHelpText': help_text("D3_CFG_CLRTMP_SET_DESC")} %}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_CREATEHTA" }) }}</td>
                                    <td>
                                        <span style="float: left; margin-right: 10px;"
                                        {% if oCfg.getValue('blClrTmp_nohtaccess') %}
                                            class="fas fa-times-circle d3fa-17x d3fa-color-red" title="{{ translate({ ident: "D3_CFG_CLRTMP_NO" }) }}"
                                        {% else %}
                                            class="fas fa-check-circle d3fa-17x d3fa-color-green" title="{{ translate({ ident: "D3_CFG_CLRTMP_YES" }) }}"
                                        {% endif %}
                                        ></span>
                                        {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_CFG_CLRTMP_SET_DESC"), 'sHelpText': help_text("D3_CFG_CLRTMP_SET_DESC")} %}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_UPDATEVIEW" }) }}</td>
                                    <td>
                                        <span style="float: left; margin-right: 10px;"
                                        {% if oCfg.getValue('blClrTmp_noviewupdate') %}
                                            class="fas fa-times-circle d3fa-17x d3fa-color-red" title="{{ translate({ ident: "D3_CFG_CLRTMP_NO" }) }}"
                                        {% else %}
                                            class="fas fa-check-circle d3fa-17x d3fa-color-green" title="{{ translate({ ident: "D3_CFG_CLRTMP_YES" }) }}"
                                        {% endif %}
                                        ></span>
                                        {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_CFG_CLRTMP_SET_DESC"), 'sHelpText': help_text("D3_CFG_CLRTMP_SET_DESC")} %}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_HASNOEXCLUDEPATTERN" }) }}</td>
                                    <td>
                                        <span style="float: left; margin-right: 10px;"
                                        {% if oCfg.getValue('sClrTmp_excluderegexp') %}
                                            class="fas fa-times-circle d3fa-17x d3fa-color-red" title="{{ translate({ ident: "D3_CFG_CLRTMP_YES" }) }}"
                                        {% else %}
                                            class="fas fa-check-circle d3fa-17x d3fa-color-green" title="{{ translate({ ident: "D3_CFG_CLRTMP_NO" }) }}"
                                        {% endif %}
                                        ></span>
                                        {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_CFG_CLRTMP_SET_DESC"), 'sHelpText': help_text("D3_CFG_CLRTMP_SET_DESC")} %}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bold">{{ translate({ ident: "D3_CFG_CLRTMP_USETICKER" }) }}</td>
                                    <td>
                                        {{ oView.getTickerThreshold() }} {{ translate({ ident: "D3_CFG_CLRTMP_USETICKERFILES" }) }}
                                        {% include "inputhelp.html.twig" with {'sHelpId': help_id("D3_CFG_CLRTMP_SET_DESC"), 'sHelpText': help_text("D3_CFG_CLRTMP_SET_DESC")} %}
                                    </td>
                                </tr>
                            {% endblock %}
                        </table>
                    </fieldset>
                {% endif %}
            {% endblock %}
        </td>
    </tr>

    <tr>
        <td colspan="2" style="padding: 15px;">
            {% block d3cleartmp_devmode %}
                {% if false == oCfg.getValue('blClrTmp_showcleartmpoptions') %}
                    <fieldset style="{% if blDevMode %}background-color: yellow;{% endif %}">
                        <legend>{{ translate({ ident: "D3_CFG_CLRTMP_DEV_LEGEND" }) }}</legend>
                        <form name="delform" id="devmode" action="{{ oViewConf.getSelfLink()|raw }}" method="post" onsubmit="{% if blShopIsProductive and not blDevMode %}alert('{{ translate({ ident: "D3_CFG_CLRTMP_DEV_DEACTPRODUCTIVE" }) }}');{% endif %} return;">
                            {{ oViewConf.getHiddenSid()|raw }}
                            <input type="hidden" name="cl" value="{{ oViewConf.getActiveClassName()|raw }}">
                            <input type="hidden" name="fnc" value="setDevelopmentMode">
                            <div style="margin: 5px 0 10px 0;">{{ translate({ ident: "D3_CFG_CLRTMP_DEV_DESC" }) }}</div>
                            <input type="hidden" name="value[blClrTmp_notmpuse]" value="{% if blDevMode %}0{% else %}1{% endif %}">
                            <span class="d3modcfg_btn icon {% if blDevMode %}d3color-green{% else %}d3color-orange{% endif %}">
                                <button type="submit" name="save" onclick=''>
                                    <i class="fa {% if blDevMode %}fa-check-circle{% else %}fa-exclamation-triangle{% endif %} fa-inverse"></i>{% if blDevMode %}{{ translate({ ident: "D3_CFG_CLRTMP_DEV_BTNDEACT" }) }}{% else %}{{ translate({ ident: "D3_CFG_CLRTMP_DEV_BTNACT" }) }}{% endif %}
                                </button>
                            </span>
                        </form>
                    </fieldset>
                {% endif %}
            {% endblock %}
        </td>
    </tr>
</table>

<div id="mask" class=""></div>
<div id="popup2" class="d3loader-2">
    <div class="d3loader-spinner">
        <div class="d3loader-circle-1"></div>
        <div class="d3loader-circle-2"></div>
        <div class="d3loader-circle-3"></div>
    </div>
</div>

{% include "@d3modcfg_lib/admin/inc/inc.html.twig" %}